"use client";

import { useSupabase } from "@/app/supabase-provider";
import { useEffect, useState, memo } from "react";

function DashboardHeaderComponent() {
  const { session } = useSupabase();
  const [userName, setUserName] = useState("‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ");

  useEffect(() => {
    if (session?.user) {
      const localProfile = localStorage.getItem(
        `chorcha-profile-${session.user.id}`,
      );
      if (localProfile) {
        const profile = JSON.parse(localProfile);
        setUserName(profile.full_name || "‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ");
      } else {
        setUserName(session.user.user_metadata?.name || "‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ");
      }
    }
  }, [session]);

  return (
    <div className="mb-8">
      <h1 className="text-3xl font-bold">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, {userName} üëã</h1>
      <p className="text-muted-foreground mt-2">‡¶ö‡¶≤‡ßÅ‡¶® ‡¶∂‡ßá‡¶ñ‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶á!</p>
    </div>
  );
}

export const DashboardHeader = memo(DashboardHeaderComponent);
